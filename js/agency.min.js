/*!
 * Start Bootstrap - Agency v5.0.7 (https://startbootstrap.com/template-overviews/agency)
 * Copyright 2013-2019 Start Bootstrap
 * Licensed under MIT (https://github.com/BlackrockDigital/startbootstrap-agency/blob/master/LICENSE)
 */

//pjs after this jqery
! function(o) {
 "use strict";

//show confirm message on edit plan page
$('#changePlan').on('click', function(ev) {
    $('#succefullyChanged').css("display", "block");
    
    if($('#monthly').hasClass('active-card')){
        if(isMobile()){
            $('#currentPlanM1').css("display", "block");
            $('#currentPlanY1').css("display", "none");  
        }
        else{
            $('#currentPlanM2').css("display", "block");
            $('#currentPlanY2').css("display", "none"); 
        }
    }
   if($('#yearly').hasClass('active-card')){
        if(isMobile()){
            $('#currentPlanM1').css("display", "none");
            $('#currentPlanY1').css("display", "block");   
        }
        else{
            $('#currentPlanM2').css("display", "none");
            $('#currentPlanY2').css("display", "block");
        }
    }
});
    
//valid email check
$('#email').on('keyup', function(ev) {
  var regex = /^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;
  if(!regex.test( $('#email').val() ))
      {
        $('#email').removeClass('is-valid');
        $('#email').addClass('is-invalid');
      }
    else{
        $('#email').removeClass('is-invalid');
        $('#email').addClass('is-valid');
    }
});

//valid email check
$('#emailFamilyMember').on('keyup', function(ev) {
  var regex = /^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;
  if(!regex.test( $('#emailFamilyMember').val() ))
      {
        $('#emailFamilyMember').removeClass('is-valid');
        $('#emailFamilyMember').addClass('is-invalid');
      }
    else{
        $('#emailFamilyMember').removeClass('is-invalid');
        $('#emailFamilyMember').addClass('is-valid');
    }
});
    
//verify password match
$("#txtConfirmPassword").on('keyup', function(ev) {
    
    var password = $("#password").val();
    var confirmPassword = $("#txtConfirmPassword").val();

    if (password != confirmPassword)
        {
            $("#divCheckPasswordMatch").css("display", "block");
            $("#divCheckPasswordMatch").html("Passwords do not match!");
            $('#txtConfirmPassword').removeClass('is-valid');
            $('#txtConfirmPassword').addClass('is-invalid');
        } 
    else{
            $("#divCheckPasswordMatch").css("display", "none");
            $('#txtConfirmPassword').removeClass('is-invalid');
            $('#txtConfirmPassword').addClass('is-valid');
        }
});
    
//if user selects centimeters get rid of inches box
$('#heightSelect').on('change', function(ev) {
    //console.log($('#heightSelect option:selected').text());
    
    if($('#heightSelect option:selected').text() == "Centimeters")
        {
           $('#inches').prop( "disabled", true );
        }
    else{
            $('#inches').prop( "disabled", false );
        }
});
    
// EXAMPLE for edit sub page
$('#monthly').addClass('active-card');
$('#monthly').append('<i class="fas fa-check check1"></i>');
$('#currentPlanM2').css("display", "block");
if(isMobile())
    {
       $('#currentPlanM1').css("display", "block"); 
    }
else{
    $('#currentPlanM1').css("display", "none");
}

//LOGO click redirect
$('.cardEdit').click(function (event) 
{   
    window.location = "Profile.html";
});

//Fills in birthday selector on add family member
$(function(){
    var $select = $("#birthY");
    for (i=2019;i>=1920;i--){
        $select.append($('<option></option>').val(i).html(i))
    }
});
    
//take away 'email is in use' on AddFamilyPlanning 
//when user moves on to pass field
$('#passwordFamilyMember').on('focus', function(ev) {
    $('#emailInUse').css("display", "none");
});

//when user types in email it should see if email is already in use
$('#emailFamilyMember').on('keyup', function(ev) {
    console.log($('#emailFamilyMember').val());
    
    if($('#emailFamilyMember').val() == "email")
        $('#emailInUse').css("display", "block");
});
    
//when clicked show confirmation message
$('#emailInUse').on('click', function(ev) {
    $('#emailHasBeenSent').css("display", "block");
    
    topFunction();
});

//when clicked show confirmation message
$('#addFamilyMember').on('click', function(ev) {
    $('#succefullyAddedFamilyMember').css("display", "block");
    
    topFunction();
});
    
//Edit Sub page select change
$('#yearly').on('click', function(ev) {
    $(this).addClass('active-card');
    $('i').remove(".fa-check");
    $(this).append('<i class="fas fa-check check2"></i>');
    
    $('#monthly').removeClass('active-card');
    $('#cancel').removeClass('active-card');
});
$('#monthly').on('click', function(ev) {
    $(this).addClass('active-card');
    $('i').remove(".fa-check");
    $(this).append('<i class="fas fa-check check1"></i>');
    
    $('#yearly').removeClass('active-card');
    $('#cancel').removeClass('active-card');
});
    
//changing value on Finished Sign Up page based on "plan" 
var pl = document.getElementById("plan");
var nm = location.search;
if(nm.indexOf("plan") >= 0 && !!pl)
{
   pl = nm.charAt(6); 
    
    console.log("Hello " + pl);
    
    if(pl == 0)
    {
        $('.titleOne').text("Reflect Monthly");
        $('.titleTwo').text("39.99");
    }
    else{
        $('.titleOne').text("Reflect Yearly");
        $('.titleTwo').text("399.99");
    }
}

//grabs plan 1 or 0
$('#sumbitBtn').click(function (event) 
{   
    //get 6th char in url, "?plan=1" -> "1"
    var plan = location.search;
    plan = plan.charAt(6);
    $('#plan').val(plan);
});
    
//grabs plan 1 or 0
$('#sumbitBtn-2').click(function (event) 
{   
    //get last char in url, "?plan=1" -> "1"
    var plan = location.search;
    console.log(plan.substr(1,plan.length-1));
});

$('#ReflectMonthly').click(function (event) 
{   
    $('#ReflectMonthly').addClass('active');
    $('#ReflectMonthlyPrice').addClass('activey');
    $('#ReflectMonthlyFeature1').addClass('activey');
    $('#ReflectMonthlyFeature2').addClass('activey');
    $('#ReflectMonthlyPriceDis').addClass('activey');
    
    $('#ReflectYearly').removeClass('active');
    $('#ReflectYearlyPrice').removeClass('activey');
    $('#ReflectYearlyFeature1').removeClass('activey');
    $('#ReflectYearlyFeature2').removeClass('activey');
    $('#ReflectYearlyPriceDis').removeClass('activey');
    
    $('#ReflectYearlyPrice').addClass('notActivey');
    $('#ReflectYearlyFeature1').addClass('notActivey');
    $('#ReflectYearlyFeature2').addClass('notActivey');
    $('#ReflectYearlyPriceDis').addClass('notActivey');
    
    $('#ReflectMonthlyPrice').removeClass('notActivey');
    $('#ReflectMonthlyFeature1').removeClass('notActivey');
    $('#ReflectMonthlyFeature2').removeClass('notActivey');
    $('#ReflectMonthlyPriceDis').removeClass('notActivey');
    
    $('#plan').val("1");
});
    
$('#ReflectYearly').click(function (event) 
{   
    $('#ReflectMonthlyPrice').removeClass('activey');
    $('#ReflectMonthlyFeature1').removeClass('activey');
    $('#ReflectMonthlyFeature2').removeClass('activey');
    $('#ReflectMonthly').removeClass('active');
    $('#ReflectMonthlyPriceDis').removeClass('activey');
    
    $('#ReflectYearlyPrice').removeClass('notActivey');
    $('#ReflectYearlyFeature1').removeClass('notActivey');
    $('#ReflectYearlyFeature2').removeClass('notActivey');
    $('#ReflectYearlyPriceDis').removeClass('notActivey');
    
    $('#ReflectYearly').addClass('active');
    $('#ReflectYearlyPrice').addClass('activey');
    $('#ReflectYearlyFeature1').addClass('activey');
    $('#ReflectYearlyFeature2').addClass('activey');
    $('#ReflectYearlyPriceDis').addClass('activey');
    
    $('#ReflectMonthlyPrice').addClass('notActivey');
    $('#ReflectMonthlyFeature1').addClass('notActivey');
    $('#ReflectMonthlyFeature2').addClass('notActivey');
    $('#ReflectMonthlyPriceDis').addClass('notActivey');
    
    $('#plan').val("0");
});
    
    
//---------------Do not touch after this point!!!------------

function checkScreenSize(){
    var newWindowWidth = $(window).width();
    if (newWindowWidth < 481) {
        return true;
    }
    return false;
}
    
var dropdown = document.getElementsByClassName("dropdown-btn");
var i;

for (i = 0; i < dropdown.length; i++) {
  dropdown[i].addEventListener("click", function() {
  this.classList.toggle("active");
  var dropdownContent = this.nextElementSibling;
  if (dropdownContent.style.display === "block") {
  dropdownContent.style.display = "none";
  } else {
  dropdownContent.style.display = "block";
  }
  });
}

//-----------THIS IS BOOTSTRAP JQ DO NOT TOUCH----------------------------
 o('a.js-scroll-trigger[href*="#"]:not([href="#"])').click(function() {
  if (location.pathname.replace(/^\//, "") == this.pathname.replace(/^\//, "") && location.hostname == this.hostname) {
   var a = o(this.hash);
   if ((a = a.length ? a : o("[name=" + this.hash.slice(1) + "]")).length) return o("html, body").animate({
    scrollTop: a.offset().top - 54
   }, 1e3, "easeInOutExpo"), !1
  }
 }), o(".js-scroll-trigger").click(function() {
  o(".navbar-collapse").collapse("hide")
 }), o("body").scrollspy({
  target: "#mainNav",
  offset: 56
 });
 var a = function() {
  100 < o("#mainNav").offset().top ? o("#mainNav").addClass("navbar-shrink") : o("#mainNav").removeClass("navbar-shrink")
 };
 a(), o(window).scroll(a), o(".portfolio-modal").on("show.bs.modal", function(a) {
  o(".navbar").addClass("d-none")
 }), o(".portfolio-modal").on("hidden.bs.modal", function(a) {
  o(".navbar").removeClass("d-none")
 })
}(jQuery);

//FAQ accordion menu
var acc = document.getElementsByClassName("accordion");
var i;

for (i = 0; i < acc.length; i++) {
  acc[i].addEventListener("click", function() {
    this.classList.toggle("active");
    var panel = this.nextElementSibling;
    if (panel.style.maxHeight){
      panel.style.maxHeight = null;
    } else {
      panel.style.maxHeight = panel.scrollHeight + "px";
    } 
  });
}

function getUrlParameter(name) {
    name = name.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]');
    var regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
    var results = regex.exec(location.search);
    return results === null ? '' : decodeURIComponent(results[1].replace(/\+/g, ' '));
};

var myInput = document.getElementById("password");
var letter = document.getElementById("letter");
var capital = document.getElementById("capital");
var number = document.getElementById("number");
var length = document.getElementById("length");

// When the user clicks on the password field, show the message box
if(!!myInput){
    myInput.onfocus = function() {
      document.getElementById("message").style.display = "block";
    }
    // When the user clicks outside of the password field, hide the message box
    myInput.onblur = function() {
      document.getElementById("message").style.display = "none";
    }
    // When the user starts to type something inside the password field
    myInput.onkeyup = function() {
      // Validate lowercase letters
      var lowerCaseLetters = /[a-z]/g;
      if(myInput.value.match(lowerCaseLetters)) {  
        letter.classList.remove("invalid");
        letter.classList.add("valid");
      } else {
        letter.classList.remove("valid");
        letter.classList.add("invalid");
      }

      // Validate capital letters
      var upperCaseLetters = /[A-Z]/g;
      if(myInput.value.match(upperCaseLetters)) {  
        capital.classList.remove("invalid");
        capital.classList.add("valid");
      } else {
        capital.classList.remove("valid");
        capital.classList.add("invalid");
      }

      // Validate numbers
      var numbers = /[0-9]/g;
      if(myInput.value.match(numbers)) {  
        number.classList.remove("invalid");
        number.classList.add("valid");
      } else {
        number.classList.remove("valid");
        number.classList.add("invalid");
      }

      // Validate length
      if(myInput.value.length >= 8) {
        length.classList.remove("invalid");
        length.classList.add("valid");
      } else {
        length.classList.remove("valid");
        length.classList.add("invalid");
      }
        
        if( $("#number").hasClass('valid') && 
           $("#letter").hasClass('valid') &&
           $("#capital").hasClass('valid') &&
           $("#length").hasClass('valid'))
            {
                $('#password').removeClass('is-invalid');
                $('#password').addClass('is-valid');
            }
        else{
                $('#password').removeClass('is-valid');
                $('#password').addClass('is-invalid');
            }
    }
}


//upload button on profile pages and add member page
var pic1 = document.getElementById('pic1');
if(pic1 != null)
    pic1.addEventListener('change', readURL, true);

var pic2 = document.getElementById('pic2');
if(pic2 != null)
    pic2.addEventListener('change', readURL2, true);

//user chooses picture and replaces div with that picture 
function readURL(){
   var file = document.getElementById(this.id).files[0];
   var reader = new FileReader();
   reader.onloadend = function(){
       
       var id = '#' + $('#pic1').closest('div').prop('id');
       
        $(id).find('.familyMemberPhoto-lg').css("backgroundImage", "url(" + reader.result + ")");
        $(id).find('.fa-user-circle').css("opacity", "0");
   }
   if(file){
      reader.readAsDataURL(file);
    }else{
    }
}
function readURL2(){
   var file = document.getElementById(this.id).files[0];
   var reader = new FileReader();
   reader.onloadend = function(){

        $('.profilePicture').css("backgroundImage", "url(" + reader.result + ")");
   }
   if(file){
      reader.readAsDataURL(file);
    }else{
    }
}

// When the user clicks on the button, scroll to the top of the document
function topFunction() {
  document.body.scrollTop = 0; // For Safari
  document.documentElement.scrollTop = 0; // For Chrome, Firefox, IE and Opera
}
function isMobile(){
    if( /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) ) {
    return true;
    }
    return false;
}